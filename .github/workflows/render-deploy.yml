name: Render Deployment Notification

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  render-deploy-info:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Render Deployment Info
      run: |
        echo "🌐 Render Deployment Triggered"
        echo "📝 Commit Message: ${{ github.event.head_commit.message }}"
        echo "👤 Author: ${{ github.event.head_commit.author.name }}"
        echo "🕒 Timestamp: $(date)"
        echo "🔧 Commit SHA: ${{ github.sha }}"
        echo ""
        echo "🎯 Deployment URLs:"
        echo "- Frontend: https://todolist-dhlt.onrender.com"
        echo "- Backend: https://todolist-dhlt-gc0d.onrender.com"
        echo ""
        echo "📋 Manual Setup Required for Render:"
        echo "1. Delete existing service and create new Static Site"
        echo "2. Build Command: npm ci --legacy-peer-deps && PUBLIC_URL=/ npm run build"
        echo "3. Publish Directory: build"
        echo "4. Environment Variables:"
        echo "   - REACT_APP_API_URL=https://todolist-dhlt-gc0d.onrender.com"
        echo "   - NODE_ENV=production"
        echo "   - PUBLIC_URL=/"
        
    - name: Check build compatibility
      run: |
        echo "🔍 Checking build compatibility..."
        node --version
        npm --version
        
    - name: Test build process
      run: |
        echo "🧪 Testing build process locally..."
        npm ci --legacy-peer-deps
        PUBLIC_URL=/ npm run build
        echo "✅ Build test completed successfully"